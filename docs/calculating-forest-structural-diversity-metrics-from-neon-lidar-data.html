<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Calculating Forest Structural Diversity Metrics from NEON LiDAR Data | Environmental Informatics Using Research Infrastructures and their Data</title>
  <meta name="description" content="Course text for NAU INF 550" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Calculating Forest Structural Diversity Metrics from NEON LiDAR Data | Environmental Informatics Using Research Infrastructures and their Data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />
  <meta property="og:description" content="Course text for NAU INF 550" />
  <meta name="github-repo" content="katharynduffy/katharynduffy.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Calculating Forest Structural Diversity Metrics from NEON LiDAR Data | Environmental Informatics Using Research Infrastructures and their Data" />
  
  <meta name="twitter:description" content="Course text for NAU INF 550" />
  <meta name="twitter:image" content="/Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />

<meta name="author" content="Dr. Katharyn Duffy, Dr. Ben Ruddell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="flux-measurements-inter-operability.html"/>
<link rel="next" href="frequently-asked-questions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">INF550: EcoInformatics data collection tools & products, </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#key-contributors"><i class="fa fa-check"></i>Key Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html"><i class="fa fa-check"></i>Pre-Course Setup: EcoInformatics Tools</a><ul>
<li class="chapter" data-level="0.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#pre-course-skills-setup"><i class="fa fa-check"></i><b>0.1</b> Pre-Course Skills &amp; Setup</a><ul>
<li class="chapter" data-level="0.1.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-or-updating-r"><i class="fa fa-check"></i><b>0.1.1</b> Installing or Updating R</a></li>
<li class="chapter" data-level="0.1.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#windows-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.2</b> Windows R/RStudio Setup</a></li>
<li class="chapter" data-level="0.1.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#mac-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.3</b> Mac R/RStudio Setup</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linux-rrstudio-setup"><i class="fa fa-check"></i><b>0.2</b> Linux R/RStudio Setup</a><ul>
<li class="chapter" data-level="0.2.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#install-basic-packages-for-this-course"><i class="fa fa-check"></i><b>0.2.1</b> Install basic packages for this course</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-and-setting-up-git-github-on-your-machine"><i class="fa fa-check"></i><b>0.3</b> Installing and Setting up Git &amp; Github on Your Machine</a></li>
<li class="chapter" data-level="0.4" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-atom"><i class="fa fa-check"></i><b>0.4</b> Installing Atom</a></li>
<li class="chapter" data-level="0.5" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linking-rstudio-to-git"><i class="fa fa-check"></i><b>0.5</b> Linking RStudio to Git</a></li>
<li class="chapter" data-level="0.6" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#how-we-will-be-conducting-this-course"><i class="fa fa-check"></i><b>0.6</b> How we will be Conducting this Course</a></li>
<li class="chapter" data-level="0.7" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercises"><i class="fa fa-check"></i><b>0.7</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html"><i class="fa fa-check"></i><b>1</b> Why ‘EcoInformatics’?</a><ul>
<li class="chapter" data-level="1.1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#the-framework-of-this-course"><i class="fa fa-check"></i><b>1.1</b> The Framework of this Course</a></li>
<li class="chapter" data-level="1.2" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#final-course-project-proposed-derived-data-product"><i class="fa fa-check"></i><b>1.2</b> Final Course Project: Proposed Derived Data Product</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html"><i class="fa fa-check"></i><b>2</b> Introduction to NEON &amp; its Data</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-neon-project-mission-design"><i class="fa fa-check"></i><b>2.2</b> The NEON Project Mission &amp; Design</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-science-and-design-of-neon"><i class="fa fa-check"></i><b>2.3</b> The Science and Design of NEON</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neons-spatial-design"><i class="fa fa-check"></i><b>2.4</b> NEON’s Spatial Design</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-samples-all-20-eco-regions"><i class="fa fa-check"></i><b>2.4.1</b> NEON Samples All 20 Eco-Regions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#how-neon-collects-data"><i class="fa fa-check"></i><b>2.5</b> How NEON Collects Data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#specimens-samples"><i class="fa fa-check"></i><b>2.5.1</b> Specimens &amp; Samples</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#airborne-remote-sensing"><i class="fa fa-check"></i><b>2.5.2</b> Airborne Remote Sensing</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#accessing-neon-data"><i class="fa fa-check"></i><b>2.6</b> Accessing NEON Data</a><ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pathways-to-access-neon-data"><i class="fa fa-check"></i><b>2.6.1</b> Pathways to access NEON Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-accessing-neon-data-user-tokens"><i class="fa fa-check"></i><b>2.7</b> Hands on: Accessing NEON Data &amp; User Tokens</a><ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#via-the-neon-api-with-your-user-token"><i class="fa fa-check"></i><b>2.7.1</b> Via the NEON API, with your User Token</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#get-a-neon-api-token"><i class="fa fa-check"></i><b>2.7.2</b> Get a NEON API Token</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#use-the-api-token-in-neonutilities"><i class="fa fa-check"></i><b>2.7.3</b> Use the API token in neonUtilities</a></li>
<li class="chapter" data-level="2.7.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#token-management-for-open-code"><i class="fa fa-check"></i><b>2.7.4</b> Token management for open code</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-neon-tos-data"><i class="fa fa-check"></i><b>2.8</b> Hands on: NEON TOS Data</a><ul>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pull-in-tree-data-from-neons-tos-and-investigate-relationships"><i class="fa fa-check"></i><b>2.8.1</b> Pull in Tree Data from NEON’s TOS and investigate relationships</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-1"><i class="fa fa-check"></i><b>2.9</b> Intro to NEON Exercises Part 1</a><ul>
<li class="chapter" data-level="2.9.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#computational"><i class="fa fa-check"></i><b>2.9.1</b> Computational</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#part-2-pulling-neon-data-via-the-api"><i class="fa fa-check"></i><b>2.10</b> Part 2: Pulling NEON Data via the API</a></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#what-is-an-api"><i class="fa fa-check"></i><b>2.11</b> What is an API?</a><ul>
<li class="chapter" data-level="2.11.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#anatomy-of-an-api-call"><i class="fa fa-check"></i><b>2.11.1</b> Anatomy of an API call</a></li>
<li class="chapter" data-level="2.11.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#targets"><i class="fa fa-check"></i><b>2.11.2</b> Targets:</a></li>
<li class="chapter" data-level="2.11.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#observational-data-os"><i class="fa fa-check"></i><b>2.11.3</b> Observational data (OS)</a></li>
<li class="chapter" data-level="2.11.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#instrumentation-data-is"><i class="fa fa-check"></i><b>2.11.4</b> Instrumentation data (IS)</a></li>
<li class="chapter" data-level="2.11.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#remote-sensing-data-aop"><i class="fa fa-check"></i><b>2.11.5</b> Remote sensing data (AOP)</a></li>
<li class="chapter" data-level="2.11.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#geolocation-data"><i class="fa fa-check"></i><b>2.11.6</b> Geolocation data</a></li>
<li class="chapter" data-level="2.11.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#querying-a-single-named-location"><i class="fa fa-check"></i><b>2.11.7</b> Querying a single named location</a></li>
<li class="chapter" data-level="2.11.8" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#taxonomy"><i class="fa fa-check"></i><b>2.11.8</b> Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#stacking-neon-data"><i class="fa fa-check"></i><b>2.12</b> Stacking NEON data</a></li>
<li class="chapter" data-level="2.13" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-written-questions"><i class="fa fa-check"></i><b>2.13</b> Intro to NEON Exercises: Written Questions</a></li>
<li class="chapter" data-level="2.14" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-2"><i class="fa fa-check"></i><b>2.14</b> Intro to NEON Exercises Part 2</a><ul>
<li class="chapter" data-level="2.14.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#written"><i class="fa fa-check"></i><b>2.14.1</b> Written</a></li>
<li class="chapter" data-level="2.14.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-coding-lab-part-2"><i class="fa fa-check"></i><b>2.14.2</b> NEON Coding Lab Part 2</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-coding-lab-part-2-1"><i class="fa fa-check"></i><b>2.15</b> NEON Coding Lab Part 2</a></li>
<li class="chapter" data-level="2.16" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-culmination-activity"><i class="fa fa-check"></i><b>2.16</b> Intro to NEON Culmination Activity</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to USA-NPN &amp; its Data</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#hands-on-accessing-usa-npn-data-via-rnpn"><i class="fa fa-check"></i><b>3.1</b> Hands on: Accessing USA-NPN Data via rNPN</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#introduction"><i class="fa fa-check"></i><b>3.1.1</b> Introduction</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accessing-usa-npn-observational-data"><i class="fa fa-check"></i><b>3.1.2</b> Accessing USA-NPN Observational Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#status-and-intensity-data"><i class="fa fa-check"></i><b>3.1.3</b> Status and Intensity Data</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#individual-phenometrics"><i class="fa fa-check"></i><b>3.1.4</b> Individual Phenometrics</a></li>
<li class="chapter" data-level="3.1.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#site-phenometrics"><i class="fa fa-check"></i><b>3.1.5</b> Site Phenometrics</a></li>
<li class="chapter" data-level="3.1.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-phenometrics"><i class="fa fa-check"></i><b>3.1.6</b> Magnitude Phenometrics</a></li>
<li class="chapter" data-level="3.1.7" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-geospatial-data"><i class="fa fa-check"></i><b>3.1.7</b> USA-NPN Geospatial Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accumulated-growing-degree-day-products"><i class="fa fa-check"></i><b>3.2</b> Accumulated Growing Degree Day Products</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#extended-spring-indices"><i class="fa fa-check"></i><b>3.3</b> Extended Spring Indices</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-layers"><i class="fa fa-check"></i><b>3.3.1</b> Other Layers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.4</b> Putting it all together:</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#combine-point-and-raster-data"><i class="fa fa-check"></i><b>3.5</b> Combine Point and Raster Data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-1-get-the-data"><i class="fa fa-check"></i><b>3.5.1</b> Step 1: Get the data</a></li>
<li class="chapter" data-level="3.5.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-2-preparing-the-data"><i class="fa fa-check"></i><b>3.5.2</b> Step 2: Preparing the data</a></li>
<li class="chapter" data-level="3.5.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-3-define-style-options-and-create-graph"><i class="fa fa-check"></i><b>3.5.3</b> Step 3: Define style options and create graph</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#live-demo-code-with-lee-marsh-of-usa-npn"><i class="fa fa-check"></i><b>3.6</b> Live Demo Code with Lee Marsh of USA-NPN</a><ul>
<li class="chapter" data-level="3.6.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#basic-utility-functions"><i class="fa fa-check"></i><b>3.6.1</b> Basic Utility Functions</a></li>
<li class="chapter" data-level="3.6.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#download-observational-data"><i class="fa fa-check"></i><b>3.6.2</b> Download Observational Data</a></li>
<li class="chapter" data-level="3.6.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-data"><i class="fa fa-check"></i><b>3.6.3</b> Magnitude Data</a></li>
<li class="chapter" data-level="3.6.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#downloading-geospatial-data"><i class="fa fa-check"></i><b>3.6.4</b> Downloading Geospatial Data</a></li>
<li class="chapter" data-level="3.6.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-together"><i class="fa fa-check"></i><b>3.6.5</b> Putting it together</a></li>
<li class="chapter" data-level="3.6.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-data-sources-e.g.daymet-modis"><i class="fa fa-check"></i><b>3.6.6</b> Other Data Sources, e.g. Daymet, MODIS</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-coding-lab"><i class="fa fa-check"></i><b>3.7</b> USA-NPN Coding Lab</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#neon-tos-phenology-data-lecture"><i class="fa fa-check"></i><b>3.8</b> NEON TOS Phenology Data Lecture</a></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#understanding-observation-biases-and-censoring-in-citizen-science-data"><i class="fa fa-check"></i><b>3.9</b> Understanding Observation Biases and Censoring in Citizen Science Data</a><ul>
<li class="chapter" data-level="3.9.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#many-existing-modeling-approaches-fail-in-one-or-both-regards."><i class="fa fa-check"></i><b>3.9.1</b> Many existing modeling approaches fail in one (or both) regards.</a></li>
<li class="chapter" data-level="3.9.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#censoring"><i class="fa fa-check"></i><b>3.9.2</b> Censoring</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#so-then-how-can-we-model-censored-data"><i class="fa fa-check"></i><b>3.10</b> So then how can we model censored data?</a></li>
<li class="chapter" data-level="3.11" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#intro-to-usa-npn-culmination-activity"><i class="fa fa-check"></i><b>3.11</b> <strong>Intro to USA-NPN Culmination Activity</strong></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html"><i class="fa fa-check"></i><b>4</b> PhenoCam: Digital Repeat Photography Networks &amp; Methods</a><ul>
<li class="chapter" data-level="4.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-networks-learning-objectives"><i class="fa fa-check"></i><b>4.1</b> Digital Repeat Photography Networks Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#the-phenocam-network-mission-design"><i class="fa fa-check"></i><b>4.2</b> The PhenoCam Network Mission &amp; Design</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#relevant-documents-background-information"><i class="fa fa-check"></i><b>4.2.1</b> Relevant documents &amp; background information:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocams-spatial-design"><i class="fa fa-check"></i><b>4.3</b> PhenoCam’s Spatial design:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-as-a-near-surface-remote-sensing-technique"><i class="fa fa-check"></i><b>4.3.1</b> PhenoCam as a Near Surface Remote Sensing Technique</a></li>
<li class="chapter" data-level="4.3.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#how-phenocams-pull-data"><i class="fa fa-check"></i><b>4.3.2</b> How PhenoCams Pull Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#leveraging-camera-near-infrared-nir-capabilities"><i class="fa fa-check"></i><b>4.3.3</b> Leveraging camera near-infrared (NIR) capabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-written-questions"><i class="fa fa-check"></i><b>4.4</b> Digital Repeat Photography Written Questions</a></li>
<li class="chapter" data-level="4.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#introduction-to-digital-repeat-photography-methods"><i class="fa fa-check"></i><b>4.5</b> Introduction to Digital Repeat Photography Methods</a></li>
<li class="chapter" data-level="4.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#pulling-data-via-the-phenocamapi-package"><i class="fa fa-check"></i><b>4.6</b> Pulling Data via the <em>phenocamapi</em> Package</a></li>
<li class="chapter" data-level="4.7" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#exploring-phenocam-metadata"><i class="fa fa-check"></i><b>4.7</b> Exploring PhenoCam metadata</a><ul>
<li class="chapter" data-level="4.7.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#remove-null-values"><i class="fa fa-check"></i><b>4.7.1</b> Remove null values</a></li>
<li class="chapter" data-level="4.7.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#filtering-using-attributes"><i class="fa fa-check"></i><b>4.7.2</b> Filtering using attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images"><i class="fa fa-check"></i><b>4.8</b> Download midday images</a><ul>
<li class="chapter" data-level="4.8.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images-for-a-given-time-range"><i class="fa fa-check"></i><b>4.8.1</b> Download midday images for a given time range</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#detecting-foggy-images-using-the-hazer-r-package"><i class="fa fa-check"></i><b>4.9</b> Detecting Foggy Images using the ‘hazer’ R Package</a></li>
<li class="chapter" data-level="4.10" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#extracting-timeseries-from-images-using-the-xroi-r-package"><i class="fa fa-check"></i><b>4.10</b> Extracting Timeseries from Images using the xROI R Package</a><ul>
<li class="chapter" data-level="4.10.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#xroi-design"><i class="fa fa-check"></i><b>4.10.1</b> xROI Design</a></li>
<li class="chapter" data-level="4.10.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#install-xroi"><i class="fa fa-check"></i><b>4.10.2</b> Install xROI</a></li>
<li class="chapter" data-level="4.10.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#launch-xroi"><i class="fa fa-check"></i><b>4.10.3</b> Launch xROI</a></li>
<li class="chapter" data-level="4.10.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#end-xroi"><i class="fa fa-check"></i><b>4.10.4</b> End xROI</a></li>
<li class="chapter" data-level="4.10.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#use-xroi"><i class="fa fa-check"></i><b>4.10.5</b> Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#documentation-and-citation"><i class="fa fa-check"></i><b>4.11</b> Documentation and Citation</a><ul>
<li class="chapter" data-level="4.11.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#challenge-use-xroi"><i class="fa fa-check"></i><b>4.11.1</b> Challenge: Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#hands-on-digital-repeat-photography-computational"><i class="fa fa-check"></i><b>4.12</b> Hands on: Digital Repeat Photography Computational</a><ul>
<li class="chapter" data-level="4.12.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-time-series"><i class="fa fa-check"></i><b>4.12.1</b> PhenoCam time series</a></li>
<li class="chapter" data-level="4.12.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#obtain-rois"><i class="fa fa-check"></i><b>4.12.2</b> Obtain ROIs</a></li>
<li class="chapter" data-level="4.12.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-time-series"><i class="fa fa-check"></i><b>4.12.3</b> Download time series</a></li>
<li class="chapter" data-level="4.12.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#threshold-values"><i class="fa fa-check"></i><b>4.12.4</b> Threshold values</a></li>
<li class="chapter" data-level="4.12.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#comparing-phenology-across-vegetation-types"><i class="fa fa-check"></i><b>4.12.5</b> Comparing phenology across vegetation types</a></li>
<li class="chapter" data-level="4.12.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space"><i class="fa fa-check"></i><b>4.12.6</b> In Class Hands-on Coding: Comparing phenology of the same plant function type (PFT) across climate space</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-coding-lab"><i class="fa fa-check"></i><b>4.13</b> Digital Repeat Photography Coding Lab</a><ul>
<li class="chapter" data-level="4.13.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#quantifying-haze-and-redness-to-evaluate-california-wildfires"><i class="fa fa-check"></i><b>4.13.1</b> Quantifying haze and redness to evaluate California wildfires</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#intro-to-phenocam-culmination-activity"><i class="fa fa-check"></i><b>4.14</b> <strong>Intro to PhenoCam Culmination Activity</strong></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html"><i class="fa fa-check"></i><b>5</b> Flux Measurements &amp; Inter-Operability</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#eddy-co_variance-data-what-does-it-actually-measure"><i class="fa fa-check"></i><b>5.2</b> Eddy Co_variance Data: What does it actually measure?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#example-eddy-site"><i class="fa fa-check"></i><b>5.2.1</b> Example Eddy Site</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#qaqc-flags"><i class="fa fa-check"></i><b>5.3</b> QA/QC Flags</a></li>
<li class="chapter" data-level="5.4" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#examples-of-other-flux-networks-ameriflux-fluxnet"><i class="fa fa-check"></i><b>5.4</b> Examples of Other Flux Networks: AMERIFLUX &amp; FLUXNET</a></li>
<li class="chapter" data-level="5.5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#the-power-of-networked-ecology-bridging-to-ameriflux-and-beyond"><i class="fa fa-check"></i><b>5.5</b> The Power of Networked Ecology: Bridging to AMERIFLUX and Beyond</a></li>
<li class="chapter" data-level="5.6" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#hands-on-introduction-to-working-with-neon-eddy-flux-data"><i class="fa fa-check"></i><b>5.6</b> Hands On: Introduction to working with NEON eddy flux data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#setup"><i class="fa fa-check"></i><b>5.6.1</b> Setup</a></li>
<li class="chapter" data-level="5.6.2" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#data-levels"><i class="fa fa-check"></i><b>5.6.2</b> Data Levels</a></li>
<li class="chapter" data-level="5.6.3" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#extract-level-4-data-fluxes"><i class="fa fa-check"></i><b>5.6.3</b> Extract Level 4 data (Fluxes!)</a></li>
<li class="chapter" data-level="5.6.4" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#time-stamps"><i class="fa fa-check"></i><b>5.6.4</b> Time stamps</a></li>
<li class="chapter" data-level="5.6.5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#merge-flux-data-with-other-sensor-data"><i class="fa fa-check"></i><b>5.6.5</b> Merge flux data with other sensor data</a></li>
<li class="chapter" data-level="5.6.6" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#vertical-profile-data-level-3"><i class="fa fa-check"></i><b>5.6.6</b> Vertical profile data (Level 3)</a></li>
<li class="chapter" data-level="5.6.7" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#un-interpolated-vertical-profile-data-level-2"><i class="fa fa-check"></i><b>5.6.7</b> Un-interpolated vertical profile data (Level 2)</a></li>
<li class="chapter" data-level="5.6.8" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#calibrated-raw-data-level-1"><i class="fa fa-check"></i><b>5.6.8</b> Calibrated raw data (Level 1)</a></li>
<li class="chapter" data-level="5.6.9" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#convert-neon-flux-data-variables-to-ameriflux-fp-standard"><i class="fa fa-check"></i><b>5.6.9</b> Convert NEON flux data variables to AmeriFlux FP standard</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercises"><i class="fa fa-check"></i><b>5.7</b> Exercises</a><ul>
<li class="chapter" data-level="5.7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#computational"><i class="fa fa-check"></i><b>5.7.1</b> Computational</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><i class="fa fa-check"></i><b>6</b> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>6.1</b> Learning Objectives</a><ul>
<li class="chapter" data-level="6.1.1" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#r-libraries-to-install"><i class="fa fa-check"></i><b>6.1.1</b> R Libraries to Install:</a></li>
<li class="chapter" data-level="6.1.2" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#data-to-download"><i class="fa fa-check"></i><b>6.1.2</b> Data to Download</a></li>
<li class="chapter" data-level="6.1.3" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#recommended-skills"><i class="fa fa-check"></i><b>6.1.3</b> Recommended Skills</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#introduction-to-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.2</b> Introduction to Structural Diversity Metrics</a></li>
<li class="chapter" data-level="6.3" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#neon-aop-discrete-return-lidar"><i class="fa fa-check"></i><b>6.3</b> NEON AOP Discrete Return LIDAR</a></li>
<li class="chapter" data-level="6.4" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#loading-the-lidar-products"><i class="fa fa-check"></i><b>6.4</b> Loading the LIDAR Products</a></li>
<li class="chapter" data-level="6.5" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#normalizing-tree-height-to-ground"><i class="fa fa-check"></i><b>6.5</b> Normalizing Tree Height to Ground</a></li>
<li class="chapter" data-level="6.6" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#calculating-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.6</b> Calculating Structural Diversity Metrics</a><ul>
<li class="chapter" data-level="6.6.1" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#generate-canopy-height-model-chm"><i class="fa fa-check"></i><b>6.6.1</b> GENERATE CANOPY HEIGHT MODEL (CHM)</a></li>
<li class="chapter" data-level="6.6.2" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#mean-outer-canopy-height-moch"><i class="fa fa-check"></i><b>6.6.2</b> MEAN OUTER CANOPY HEIGHT (MOCH)</a></li>
<li class="chapter" data-level="6.6.3" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#max-canopy-height"><i class="fa fa-check"></i><b>6.6.3</b> MAX CANOPY HEIGHT</a></li>
<li class="chapter" data-level="6.6.4" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#rumple"><i class="fa fa-check"></i><b>6.6.4</b> RUMPLE</a></li>
<li class="chapter" data-level="6.6.5" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#top-rugosity"><i class="fa fa-check"></i><b>6.6.5</b> TOP RUGOSITY</a></li>
<li class="chapter" data-level="6.6.6" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#deep-gaps-deep-gap-fraction"><i class="fa fa-check"></i><b>6.6.6</b> DEEP GAPS &amp; DEEP GAP FRACTION</a></li>
<li class="chapter" data-level="6.6.7" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#cover-fraction"><i class="fa fa-check"></i><b>6.6.7</b> COVER FRACTION</a></li>
<li class="chapter" data-level="6.6.8" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#vci"><i class="fa fa-check"></i><b>6.6.8</b> VCI</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#combining-everything-into-one-function"><i class="fa fa-check"></i><b>6.7</b> Combining Everything Into One Function</a></li>
<li class="chapter" data-level="6.8" data-path="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html"><a href="calculating-forest-structural-diversity-metrics-from-neon-lidar-data.html#comparing-metrics-between-forests"><i class="fa fa-check"></i><b>6.8</b> Comparing Metrics Between Forests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i>Frequently Asked Questions:</a><ul>
<li class="chapter" data-level="6.9" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#where-can-i-find-due-dates-for-assignments"><i class="fa fa-check"></i><b>6.9</b> Where can I find due dates for assignments?</a></li>
<li class="chapter" data-level="6.10" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-do-i-submit-assignments"><i class="fa fa-check"></i><b>6.10</b> How do I submit assignments?</a></li>
<li class="chapter" data-level="6.11" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf"><i class="fa fa-check"></i><b>6.11</b> Do I still have to submit written exercises as .Rmd and .pdf?</a></li>
<li class="chapter" data-level="6.12" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#whats-better-for-code-conciseness-or-readability"><i class="fa fa-check"></i><b>6.12</b> What’s better for code, conciseness or readability?</a></li>
<li class="chapter" data-level="6.13" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-find-i-find-resources-to-navigate-the-neon-data-portal"><i class="fa fa-check"></i><b>6.13</b> How find I find resources to navigate the NEON Data Portal?</a></li>
<li class="chapter" data-level="6.14" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-can-i-best-prepare-for-class-and-succeed"><i class="fa fa-check"></i><b>6.14</b> How can I best prepare for class and succeed?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/katharynduffy/katharynduffy.github.io" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Informatics Using Research Infrastructures and their Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calculating-forest-structural-diversity-metrics-from-neon-lidar-data" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data</h1>
<blockquote>
<p>Contributors: Jeff Atkins, Keith Krause, Atticus Stovall
Authors: Elizabeth LaRue, Donal O’Leary</p>
</blockquote>
<div id="learning-objectives" class="section level2">
<h2><span class="header-section-number">6.1</span> Learning Objectives</h2>
<p>After completing this tutorial, you will be able to:</p>
<ul>
<li>Read a NEON LiDAR file (laz) into R</li>
<li>Visualize a spatial subset of the LiDAR tile</li>
<li>Correct a spatial subset of the LiDAR tile for topographic varation</li>
<li>Calculate 13 structural diversity metrics described in <a href="https://doi.org/10.3390/rs12091407" target="_blank">LaRue, Wagner, et al. (2020) </a></li>
</ul>
<div id="r-libraries-to-install" class="section level3">
<h3><span class="header-section-number">6.1.1</span> R Libraries to Install:</h3>
<ul>
<li><strong>lidR</strong>: <code>install.packages('lidR')</code></li>
<li><strong>gstat</strong>: <code>install.packages('gstat')</code></li>
</ul>
<p><strong>Important Note:</strong>
If you have R version 3.6 or above you’ll need to update <code>data.table</code>:</p>
<pre><code>data.table::update.dev.pkg()</code></pre>
</div>
<div id="data-to-download" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Data to Download</h3>
<p>For this tutorial, we will be using two .laz files containing NEON
AOP point clouds for 1km tiles from the <a href="https://www.neonscience.org/field-sites/field-sites-map/HARV" target="_blank">Harvard Forest (HARV)</a> and
<a href="https://www.neonscience.org/field-sites/field-sites-map/TEAK" target="_blank">Lower Teakettle (TEAK)</a> sites.</p>
<p><a href="https://drive.google.com/open?id=1Aemh0IVKvC-LoMj2AXr9k8rDQk77l8k7" target="_blank"> <strong>Link to download .laz files on Google Drive Here.</strong></a></p>
</div>
<div id="recommended-skills" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Recommended Skills</h3>
<p>For this tutorial, you should have an understanding of Light Detection
And Ranging (LiDAR) technology, specifically how discrete return lidar
data are collected and represented in las/laz files. For more information
on how lidar works, please see this
<a href="https://www.youtube.com/watch?v=EYbhNSUnIdU" target="_blank"> primer video </a>
and
<a href="https://www.neonscience.org/intro-lidar-r-series" target="_blank"> Introduction to Lidar Tutorial Series.</a></p>
</div>
</div>
</div>
<div id="introduction-to-structural-diversity-metrics" class="section level2">
<h2><span class="header-section-number">6.2</span> Introduction to Structural Diversity Metrics</h2>
<p>Forest structure influences many important ecological processes, including
biogeochemical cycling, wildfires, species richness and diversity, and many
others. Quantifying forest structure, hereafter referred to as “structural
diversity,” presents a challenge for many reasons, including difficulty in
measuring individual trees, limbs, and leaves across large areas. In order
to overcome this challenge, today’s researchers use Light Detection And
Ranging (LiDAR) technology to measure large areas of forest. It is also
challenging to calculate meaningful summary metrics of a forest’s structure
that 1) are ecologically relevant and 2) can be used to compare different
forested locations. In this tutorial, you will be introduced to a few tools
that will help you to explore and quantify forest structure using LiDAR data
collected at two field sites of the
<a href="https://www.neonscience.org/" target="_blank">
National Ecological Observatory Network</a>.</p>
</div>
<div id="neon-aop-discrete-return-lidar" class="section level2">
<h2><span class="header-section-number">6.3</span> NEON AOP Discrete Return LIDAR</h2>
<p><a href="https://www.neonscience.org/data-collection/airborne-remote-sensing" target="_blank"> The NEON Airborne Observation Platform (AOP) </a>.
has several sensors including discrete-return LiDAR, which is useful for measuring forest structural diversity that can be summarized into four categories of metrics: (1) canopy height, (2) canopy cover and openness, and (3) canopy heterogeneity (internal and external), and (4) vegetation area.</p>
<p>We will be comparing the structural diversity of two NEON sites that vary in their structural characteristics.</p>
<p>First, we will look at <a href="https://www.neonscience.org/field-sites/field-sites-map/HARV" target="_blank">Harvard Forest (HARV)</a>, which is located in Massachusetts. It is a lower elevation, mixed deciduous and evergreen forest dominated by Quercus rubra, Acer rubrum, and Aralia nudicaulis.</p>
<p>Second, we will look at <a href="https://www.neonscience.org/field-sites/field-sites-map/TEAK" target="_blank">Lower Teakettle (TEAK)</a>, which is a high elevation forested NEON site in California. TEAK is an evergreen forest dominated by Abies magnifica, Abies concolor, Pinus jeffreyi, and Pinus contorta.</p>
<p>As you can imagine, these two forest types will have both similarities and differences in their structural attributes. We can quantify these attributes by calculating several different structural diversity metrics, and comparing
the results.</p>
</div>
<div id="loading-the-lidar-products" class="section level2">
<h2><span class="header-section-number">6.4</span> Loading the LIDAR Products</h2>
<p>To begin, we first need to load our required R packages, and set our working
directory to the location where we saved the input LiDAR .laz files that can be
downloaded from the NEON Data Portal.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" data-line-number="1"><span class="kw">library</span>(lidR)</a></code></pre></div>
<pre><code>## Loading required package: raster</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" data-line-number="1"><span class="kw">library</span>(gstat)</a>
<a class="sourceLine" id="cb438-2" data-line-number="2"><span class="kw">library</span>(data.table)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     shift</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" data-line-number="1"><span class="kw">library</span>(kableExtra)</a></code></pre></div>
<p>Next, we will read in the LiDAR data using the <code>lidR::readLAS()</code> function.
Note that this function can read in both <code>.las</code> and <code>.laz</code> file formats.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1"><span class="co"># Read in LiDAR data </span></a>
<a class="sourceLine" id="cb442-2" data-line-number="2"><span class="co">#2017 1 km2 tile .laz file type for HARV and TEAK</span></a>
<a class="sourceLine" id="cb442-3" data-line-number="3"></a>
<a class="sourceLine" id="cb442-4" data-line-number="4"><span class="co">#Watch out for outlier Z points - this function also allows for the</span></a>
<a class="sourceLine" id="cb442-5" data-line-number="5"><span class="co">#ability to filter outlier points well above or below the landscape</span></a>
<a class="sourceLine" id="cb442-6" data-line-number="6"><span class="co">#(-drop_z_blow and -drop_z_above). See how we have done this here </span></a>
<a class="sourceLine" id="cb442-7" data-line-number="7"><span class="co">#for you.</span></a>
<a class="sourceLine" id="cb442-8" data-line-number="8"></a>
<a class="sourceLine" id="cb442-9" data-line-number="9">HARV &lt;-<span class="st"> </span>lidR<span class="op">::</span><span class="kw">readLAS</span>(<span class="st">&#39;/Users/kdw223/Research/katharynduffy.github.io/data/NEON_D01_HARV_DP1_727000_4702000_classified_point_cloud_colorized.laz&#39;</span>,<span class="dt">filter =</span> <span class="st">&quot;-drop_z_below 150 -drop_z_above 325&quot;</span>)</a>
<a class="sourceLine" id="cb442-10" data-line-number="10"></a>
<a class="sourceLine" id="cb442-11" data-line-number="11">TEAK &lt;-<span class="st"> </span>lidR<span class="op">::</span><span class="kw">readLAS</span>(<span class="st">&#39;/Users/kdw223/Research/katharynduffy.github.io/data/NEON_D17_TEAK_DP1_316000_4091000_classified_point_cloud_colorized.laz&#39;</span>,<span class="dt">filter =</span> <span class="st">&quot;-drop_z_below 1694 -drop_z_above 2500&quot;</span>)</a></code></pre></div>
<p>Let’s check out:</p>
<ol style="list-style-type: decimal">
<li>the extent,</li>
<li>coordinate system,</li>
<li>and a 3D plot of each .laz file.</li>
</ol>
<p><em>Note that on Mac computers you may need to install
XQuartz for 3D plots - see xquartz.org</em></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" data-line-number="1"><span class="kw">summary</span>(HARV)</a>
<a class="sourceLine" id="cb443-2" data-line-number="2">lidR<span class="op">::</span><span class="kw">plot</span>(HARV)</a></code></pre></div>
<pre><code>class        : LAS (v1.3 format 3)
memory       : 521.6 Mb 
extent       : 727000, 728000, 4702000, 4703000 (xmin, xmax, ymin, ymax)
coord. ref.  : +proj=utm +zone=18 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
area         : 1 km²
points       : 5.94 million points
density      : 5.94 points/m²
File signature:           LASF� 
File source ID:           211 
Global encoding:
 - GPS Time Type: GPS Week Time 
 - Synthetic Return Numbers: no 
 - Well Know Text: CRS is GeoTIFF 
 - Aggregate Model: false 
Project ID - GUID:        00000000-0000-0000-0000-000000000000 
Version:                  1.3
System identifier:        LAStools (c) by rapidlasso GmbH 
Generating software:      lascolor (190812) commercial 
File creation d/y:        278/2019
header size:              235 
Offset to point data:     329 
Num. var. length record:  1 
Point data format:        3 
Point data record length: 34 
Num. of point records:    5944282 
Num. of points by return: 4581566 1255117 104991 2608 0 
Scale factor X Y Z:       0.01 0.01 0.01 
Offset X Y Z:             7e+05 4700000 0 
min X Y Z:                727000 4702000 223.2 
max X Y Z:                728000 4703000 324.99 
Variable length records: 
   Variable length record 1 of 1 
       Description:  
       Tags:
          Key 1024 value 1 
          Key 1025 value 2 
          Key 3072 value 32618 
          Key 4099 value 9001 </code></pre>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/HARV1km2.JPG" /></p>
<blockquote>
<p>1 km-squared point cloud from Harvard Forest showing a gentle slope covered in a continuous canopy of mixed forest.</p>
</blockquote>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1"><span class="kw">summary</span>(TEAK)</a>
<a class="sourceLine" id="cb445-2" data-line-number="2">lidR<span class="op">::</span><span class="kw">plot</span>(TEAK)</a></code></pre></div>
<pre><code>class        : LAS (v1.3 format 3)
memory       : 439.2 Mb 
extent       : 316000, 317000, 4091231, 4092000 (xmin, xmax, ymin, ymax)
coord. ref.  : +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
area         : 0.75 km²
points       : 5.01 million points
density      : 6.7 points/m²
File signature:           LASF� 
File source ID:           211 
Global encoding:
 - GPS Time Type: GPS Week Time 
 - Synthetic Return Numbers: no 
 - Well Know Text: CRS is GeoTIFF 
 - Aggregate Model: false 
Project ID - GUID:        00000000-0000-0000-0000-000000000000 
Version:                  1.3
System identifier:        LAStools (c) by rapidlasso GmbH 
Generating software:      lascolor (190812) commercial 
File creation d/y:        206/2019
header size:              235 
Offset to point data:     329 
Num. var. length record:  1 
Point data format:        3 
Point data record length: 34 
Num. of point records:    5006002 
Num. of points by return: 3315380 1182992 416154 91476 0 
Scale factor X Y Z:       0.01 0.01 0.01 
Offset X Y Z:             3e+05 4e+06 0 
min X Y Z:                316000 4091231 2117.03 
max X Y Z:                317000 4092000 2376.98 
Variable length records: 
   Variable length record 1 of 1 
       Description:  
       Tags:
          Key 1024 value 1 
          Key 1025 value 2 
          Key 3072 value 32611 
          Key 4099 value 9001</code></pre>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/TEAK1km2.JPG" /></p>
<blockquote>
<p>1 km-squared point cloud from Lower Teakettle showing mountainous terrain covered in a patchy conifer forest, with tall, skinny conifers clearly visible emerging from the discontinuous canopy.</p>
</blockquote>
</div>
<div id="normalizing-tree-height-to-ground" class="section level2">
<h2><span class="header-section-number">6.5</span> Normalizing Tree Height to Ground</h2>
<p>To begin, we will take a look at the structural diversity of the dense mixed deciduous/evergreen
forest of HARV. We’re going to choose a 40 x 40 m spatial extent for our analysis, but first we
need to normalize the height values of this LiDAR point cloud from an absolute elevation
above mean sea level to height above the ground using the <code>lidR::lasnormalize()</code> function.</p>
<p>This function relies on spatial interpolation, and therefore we want to perform this step on an area
that is quite a bit larger than our area of interest to avoid edge effects.</p>
<p>To be safe, we will clip out an area of 200 x 200 m, normalize it, and then clip out our smaller area of interest.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="co"># Correct for elevation </span></a>
<a class="sourceLine" id="cb447-2" data-line-number="2"><span class="co">#We&#39;re going to choose a 40 x 40 m spatial extent, which is the</span></a>
<a class="sourceLine" id="cb447-3" data-line-number="3"><span class="co">#extent for NEON base plots. </span></a>
<a class="sourceLine" id="cb447-4" data-line-number="4"><span class="co">#First set the center of where you want the plot to be (note easting </span></a>
<a class="sourceLine" id="cb447-5" data-line-number="5"><span class="co">#and northing works in units of m because these data are in a UTM </span></a>
<a class="sourceLine" id="cb447-6" data-line-number="6"><span class="co">#proejction as shown in the summary above).</span></a>
<a class="sourceLine" id="cb447-7" data-line-number="7">x &lt;-<span class="st"> </span><span class="dv">727500</span> <span class="co">#easting </span></a>
<a class="sourceLine" id="cb447-8" data-line-number="8">y &lt;-<span class="st"> </span><span class="dv">4702500</span> <span class="co">#northing</span></a>
<a class="sourceLine" id="cb447-9" data-line-number="9"></a>
<a class="sourceLine" id="cb447-10" data-line-number="10"><span class="co">#Cut out a 200 x 200 m buffer by adding 100 m to easting and </span></a>
<a class="sourceLine" id="cb447-11" data-line-number="11"><span class="co">#northing coordinates (x,y).</span></a>
<a class="sourceLine" id="cb447-12" data-line-number="12">data<span class="fl">.200</span>m &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb447-13" data-line-number="13"><span class="st">   </span><span class="kw">lasclipRectangle</span>(HARV,</a>
<a class="sourceLine" id="cb447-14" data-line-number="14">                    <span class="dt">xleft =</span> (x <span class="op">-</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ybottom =</span> (y <span class="op">-</span><span class="st"> </span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb447-15" data-line-number="15">                    <span class="dt">xright =</span> (x <span class="op">+</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ytop =</span> (y <span class="op">+</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb447-16" data-line-number="16"></a>
<a class="sourceLine" id="cb447-17" data-line-number="17"><span class="co">#Correct for ground height using a kriging function to interpolate </span></a>
<a class="sourceLine" id="cb447-18" data-line-number="18"><span class="co">#elevation from ground points in the .laz file.</span></a>
<a class="sourceLine" id="cb447-19" data-line-number="19"><span class="co">#If the function will not run, then you may need to checkfor outliers</span></a>
<a class="sourceLine" id="cb447-20" data-line-number="20"><span class="co">#by adjusting the &#39;drop_z_&#39; arguments when reading in the .laz files.</span></a>
<a class="sourceLine" id="cb447-21" data-line-number="21">dtm &lt;-<span class="st"> </span><span class="kw">grid_terrain</span>(data<span class="fl">.200</span>m, <span class="dv">1</span>, <span class="kw">kriging</span>(<span class="dt">k =</span> 10L))</a></code></pre></div>
<pre><code>## Warning: There were 7 degenerated ground points. Some X Y coordinates were
## repeated but with different Z coordinates. min Z were retained.</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" data-line-number="1">data<span class="fl">.200</span>m &lt;-<span class="st"> </span><span class="kw">lasnormalize</span>(data<span class="fl">.200</span>m, dtm)</a>
<a class="sourceLine" id="cb449-2" data-line-number="2"></a>
<a class="sourceLine" id="cb449-3" data-line-number="3"><span class="co">#Will often give a warning if not all points could be corrected, </span></a>
<a class="sourceLine" id="cb449-4" data-line-number="4"><span class="co">#but visually check to see if it corrected for ground height. </span></a>
<a class="sourceLine" id="cb449-5" data-line-number="5">lidR<span class="op">::</span><span class="kw">plot</span>(data<span class="fl">.200</span>m)</a></code></pre></div>
<pre><code>## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</code></pre>
<pre><code>## Warning: &#39;rgl.init&#39; failed, running with &#39;rgl.useNULL = TRUE&#39;.</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb452-1" data-line-number="1"><span class="co">#There&#39;s only a few uncorrected points and we&#39;ll fix these in </span></a>
<a class="sourceLine" id="cb452-2" data-line-number="2"><span class="co">#the next step. </span></a>
<a class="sourceLine" id="cb452-3" data-line-number="3"></a>
<a class="sourceLine" id="cb452-4" data-line-number="4"><span class="co">#Clip 20 m out from each side of the easting and northing </span></a>
<a class="sourceLine" id="cb452-5" data-line-number="5"><span class="co">#coordinates (x,y).</span></a>
<a class="sourceLine" id="cb452-6" data-line-number="6">data<span class="fl">.40</span>m &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb452-7" data-line-number="7"><span class="st">   </span><span class="kw">lasclipRectangle</span>(data<span class="fl">.200</span>m, </a>
<a class="sourceLine" id="cb452-8" data-line-number="8">                    <span class="dt">xleft =</span> (x <span class="op">-</span><span class="st"> </span><span class="dv">20</span>), <span class="dt">ybottom =</span> (y <span class="op">-</span><span class="st"> </span><span class="dv">20</span>),</a>
<a class="sourceLine" id="cb452-9" data-line-number="9">                    <span class="dt">xright =</span> (x <span class="op">+</span><span class="st"> </span><span class="dv">20</span>), <span class="dt">ytop =</span> (y <span class="op">+</span><span class="st"> </span><span class="dv">20</span>))</a>
<a class="sourceLine" id="cb452-10" data-line-number="10"></a>
<a class="sourceLine" id="cb452-11" data-line-number="11">data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z[data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.5</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>  </a>
<a class="sourceLine" id="cb452-12" data-line-number="12"><span class="co">#This line filters out all z_vals below .5 m as we are less </span></a>
<a class="sourceLine" id="cb452-13" data-line-number="13"><span class="co">#interested in shrubs/trees. </span></a>
<a class="sourceLine" id="cb452-14" data-line-number="14"><span class="co">#You could change it to zero or another height depending on interests. </span></a>
<a class="sourceLine" id="cb452-15" data-line-number="15"></a>
<a class="sourceLine" id="cb452-16" data-line-number="16"><span class="co">#visualize the clipped plot point cloud</span></a>
<a class="sourceLine" id="cb452-17" data-line-number="17">lidR<span class="op">::</span><span class="kw">plot</span>(data<span class="fl">.40</span>m) </a></code></pre></div>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/HARV40mx40m.JPG" /></p>
<blockquote>
<p>40 meter by 40 meter point cloud from Harvard Forest showing a cross-section of the forest structure with a complex canopy- and sub-canopy structure with many rounded crowns, characteristic of a deciduous-dominated section of forest.</p>
</blockquote>
</div>
<div id="calculating-structural-diversity-metrics" class="section level2">
<h2><span class="header-section-number">6.6</span> Calculating Structural Diversity Metrics</h2>
<p>Now that we have our area of interest normalized and clipped, we can proceed with calculating
our structural diversity metrics.</p>
<div id="generate-canopy-height-model-chm" class="section level3">
<h3><span class="header-section-number">6.6.1</span> GENERATE CANOPY HEIGHT MODEL (CHM)</h3>
<p>(i.e. a 1 m2 raster grid of vegetations heights)</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="co"># Structural diversity metrics</span></a>
<a class="sourceLine" id="cb453-2" data-line-number="2"></a>
<a class="sourceLine" id="cb453-3" data-line-number="3"></a>
<a class="sourceLine" id="cb453-4" data-line-number="4"><span class="co">#res argument specifies pixel size in meters and dsmtin is </span></a>
<a class="sourceLine" id="cb453-5" data-line-number="5"><span class="co">#for raster interpolation</span></a>
<a class="sourceLine" id="cb453-6" data-line-number="6">chm &lt;-<span class="st"> </span><span class="kw">grid_canopy</span>(data<span class="fl">.40</span>m, <span class="dt">res =</span> <span class="dv">1</span>, <span class="kw">dsmtin</span>())  </a>
<a class="sourceLine" id="cb453-7" data-line-number="7"></a>
<a class="sourceLine" id="cb453-8" data-line-number="8"><span class="co">#visualize CHM</span></a>
<a class="sourceLine" id="cb453-9" data-line-number="9">lidR<span class="op">::</span><span class="kw">plot</span>(chm) </a></code></pre></div>
</div>
<div id="mean-outer-canopy-height-moch" class="section level3">
<h3><span class="header-section-number">6.6.2</span> MEAN OUTER CANOPY HEIGHT (MOCH)</h3>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" data-line-number="1"><span class="co">#calculate MOCH, the mean CHM height value</span></a>
<a class="sourceLine" id="cb454-2" data-line-number="2">mean.max.canopy.ht &lt;-<span class="st"> </span><span class="kw">mean</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
</div>
<div id="max-canopy-height" class="section level3">
<h3><span class="header-section-number">6.6.3</span> MAX CANOPY HEIGHT</h3>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="co">#calculate HMAX, the maximum CHM height value</span></a>
<a class="sourceLine" id="cb455-2" data-line-number="2">max.canopy.ht &lt;-<span class="st"> </span><span class="kw">max</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) </a></code></pre></div>
</div>
<div id="rumple" class="section level3">
<h3><span class="header-section-number">6.6.4</span> RUMPLE</h3>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" data-line-number="1"><span class="co">#calculate rumple, a ratio of outer canopy surface area to </span></a>
<a class="sourceLine" id="cb456-2" data-line-number="2"><span class="co">#ground surface area (1600 m^2)</span></a>
<a class="sourceLine" id="cb456-3" data-line-number="3">rumple &lt;-<span class="st"> </span><span class="kw">rumple_index</span>(chm) </a></code></pre></div>
</div>
<div id="top-rugosity" class="section level3">
<h3><span class="header-section-number">6.6.5</span> TOP RUGOSITY</h3>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="co">#top rugosity, the standard deviation of pixel values in chm and </span></a>
<a class="sourceLine" id="cb457-2" data-line-number="2"><span class="co">#is a measure of outer canopy roughness</span></a>
<a class="sourceLine" id="cb457-3" data-line-number="3">top.rugosity &lt;-<span class="st"> </span><span class="kw">sd</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
</div>
<div id="deep-gaps-deep-gap-fraction" class="section level3">
<h3><span class="header-section-number">6.6.6</span> DEEP GAPS &amp; DEEP GAP FRACTION</h3>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" data-line-number="1"><span class="co">#number of cells in raster (also area in m2)</span></a>
<a class="sourceLine" id="cb458-2" data-line-number="2">cells &lt;-<span class="st"> </span><span class="kw">length</span>(chm<span class="op">@</span>data<span class="op">@</span>values) </a>
<a class="sourceLine" id="cb458-3" data-line-number="3">chm<span class="fl">.0</span> &lt;-<span class="st"> </span>chm</a>
<a class="sourceLine" id="cb458-4" data-line-number="4">chm<span class="fl">.0</span>[<span class="kw">is.na</span>(chm<span class="fl">.0</span>)] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#replace NAs with zeros in CHM</span></a>
<a class="sourceLine" id="cb458-5" data-line-number="5"><span class="co">#create variable for the number of deep gaps, 1 m^2 canopy gaps</span></a>
<a class="sourceLine" id="cb458-6" data-line-number="6">zeros &lt;-<span class="st"> </span><span class="kw">which</span>(chm<span class="fl">.0</span><span class="op">@</span>data<span class="op">@</span>values <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb458-7" data-line-number="7">deepgaps &lt;-<span class="st"> </span><span class="kw">length</span>(zeros) <span class="co">#number of deep gaps</span></a>
<a class="sourceLine" id="cb458-8" data-line-number="8"><span class="co">#deep gap fraction, the number of deep gaps in the chm relative </span></a>
<a class="sourceLine" id="cb458-9" data-line-number="9"><span class="co">#to total number of chm pixels</span></a>
<a class="sourceLine" id="cb458-10" data-line-number="10">deepgap.fraction &lt;-<span class="st"> </span>deepgaps<span class="op">/</span>cells </a></code></pre></div>
</div>
<div id="cover-fraction" class="section level3">
<h3><span class="header-section-number">6.6.7</span> COVER FRACTION</h3>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1"><span class="co">#cover fraction, the inverse of deep gap fraction</span></a>
<a class="sourceLine" id="cb459-2" data-line-number="2">cover.fraction &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>deepgap.fraction </a>
<a class="sourceLine" id="cb459-3" data-line-number="3"></a>
<a class="sourceLine" id="cb459-4" data-line-number="4"><span class="co">#HEIGHT SD</span></a>
<a class="sourceLine" id="cb459-5" data-line-number="5"><span class="co">#height SD, the standard deviation of height values for all points</span></a>
<a class="sourceLine" id="cb459-6" data-line-number="6"><span class="co">#in the plot point cloud</span></a>
<a class="sourceLine" id="cb459-7" data-line-number="7">vert.sd &lt;-<span class="st"> </span><span class="kw">cloud_metrics</span>(data<span class="fl">.40</span>m, <span class="kw">sd</span>(Z, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </a>
<a class="sourceLine" id="cb459-8" data-line-number="8"></a>
<a class="sourceLine" id="cb459-9" data-line-number="9"></a>
<a class="sourceLine" id="cb459-10" data-line-number="10"><span class="co">#SD of VERTICAL SD of HEIGHT</span></a>
<a class="sourceLine" id="cb459-11" data-line-number="11"><span class="co">#rasterize plot point cloud and calculate the standard deviation </span></a>
<a class="sourceLine" id="cb459-12" data-line-number="12"><span class="co">#of height values at a resolution of 1 m^2</span></a>
<a class="sourceLine" id="cb459-13" data-line-number="13">sd<span class="fl">.1</span>m2 &lt;-<span class="st"> </span><span class="kw">grid_metrics</span>(data<span class="fl">.40</span>m, <span class="kw">sd</span>(Z), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb459-14" data-line-number="14"><span class="co">#standard deviation of the calculated standard deviations </span></a>
<a class="sourceLine" id="cb459-15" data-line-number="15"><span class="co">#from previous line </span></a>
<a class="sourceLine" id="cb459-16" data-line-number="16"><span class="co">#This is a measure of internal and external canopy complexity</span></a>
<a class="sourceLine" id="cb459-17" data-line-number="17">sd.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(sd<span class="fl">.1</span>m2[,<span class="dv">3</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb459-18" data-line-number="18"></a>
<a class="sourceLine" id="cb459-19" data-line-number="19"></a>
<a class="sourceLine" id="cb459-20" data-line-number="20"><span class="co">#some of the next few functions won&#39;t handle NAs, so we need </span></a>
<a class="sourceLine" id="cb459-21" data-line-number="21"><span class="co">#to filter these out of a vector of Z points</span></a>
<a class="sourceLine" id="cb459-22" data-line-number="22">Zs &lt;-<span class="st"> </span>data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z</a>
<a class="sourceLine" id="cb459-23" data-line-number="23">Zs &lt;-<span class="st"> </span>Zs[<span class="op">!</span><span class="kw">is.na</span>(Zs)]</a>
<a class="sourceLine" id="cb459-24" data-line-number="24"></a>
<a class="sourceLine" id="cb459-25" data-line-number="25"><span class="co">#ENTROPY </span></a>
<a class="sourceLine" id="cb459-26" data-line-number="26"><span class="co">#entropy, quantifies diversity &amp; evenness of point cloud heights </span></a>
<a class="sourceLine" id="cb459-27" data-line-number="27"><span class="co">#by = 1 partitions point cloud in 1 m tall horizontal slices </span></a>
<a class="sourceLine" id="cb459-28" data-line-number="28"><span class="co">#ranges from 0-1, with 1 being more evenly distributed points </span></a>
<a class="sourceLine" id="cb459-29" data-line-number="29"><span class="co">#across the 1 m tall slices </span></a>
<a class="sourceLine" id="cb459-30" data-line-number="30">entro &lt;-<span class="st"> </span><span class="kw">entropy</span>(Zs, <span class="dt">by =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb459-31" data-line-number="31"></a>
<a class="sourceLine" id="cb459-32" data-line-number="32"><span class="co">#GAP FRACTION PROFILE </span></a>
<a class="sourceLine" id="cb459-33" data-line-number="33"><span class="co">#gap fraction profile, assesses the distribution of gaps in the </span></a>
<a class="sourceLine" id="cb459-34" data-line-number="34"><span class="co">#canopy volume </span></a>
<a class="sourceLine" id="cb459-35" data-line-number="35"><span class="co">#dz = 1 partitions point cloud in 1 m horizontal slices </span></a>
<a class="sourceLine" id="cb459-36" data-line-number="36"><span class="co">#z0 is set to a reasonable height based on the age and height of </span></a>
<a class="sourceLine" id="cb459-37" data-line-number="37"><span class="co">#the study sites </span></a>
<a class="sourceLine" id="cb459-38" data-line-number="38">gap_frac &lt;-<span class="st"> </span><span class="kw">gap_fraction_profile</span>(Zs, <span class="dt">dz =</span> <span class="dv">1</span>, <span class="dt">z0=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb459-39" data-line-number="39"><span class="co">#defines gap fraction profile as the average gap fraction in each </span></a>
<a class="sourceLine" id="cb459-40" data-line-number="40"><span class="co">#1 m horizontal slice assessed in the previous line</span></a>
<a class="sourceLine" id="cb459-41" data-line-number="41">GFP.AOP &lt;-<span class="st"> </span><span class="kw">mean</span>(gap_frac<span class="op">$</span>gf) </a>
<a class="sourceLine" id="cb459-42" data-line-number="42"></a>
<a class="sourceLine" id="cb459-43" data-line-number="43"><span class="co">#VAI</span></a>
<a class="sourceLine" id="cb459-44" data-line-number="44"><span class="co">#leaf area density, assesses leaf area in the canopy volume </span></a>
<a class="sourceLine" id="cb459-45" data-line-number="45"><span class="co">#k = 0.5 is a standard extinction coefficient for foliage </span></a>
<a class="sourceLine" id="cb459-46" data-line-number="46"><span class="co">#dz = 1 partitions point cloud in 1 m horizontal slices </span></a>
<a class="sourceLine" id="cb459-47" data-line-number="47"><span class="co">#z0 is set to the same height as gap fraction profile above</span></a>
<a class="sourceLine" id="cb459-48" data-line-number="48">LADen&lt;-<span class="kw">LAD</span>(Zs, <span class="dt">dz =</span> <span class="dv">1</span>, <span class="dt">k=</span><span class="fl">0.5</span>, <span class="dt">z0=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb459-49" data-line-number="49"><span class="co">#vegetation area index, sum of leaf area density values for </span></a>
<a class="sourceLine" id="cb459-50" data-line-number="50"><span class="co">#all horizontal slices assessed in previous line</span></a>
<a class="sourceLine" id="cb459-51" data-line-number="51">VAI.AOP &lt;-<span class="st"> </span><span class="kw">sum</span>(LADen<span class="op">$</span>lad, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) </a></code></pre></div>
</div>
<div id="vci" class="section level3">
<h3><span class="header-section-number">6.6.8</span> VCI</h3>
<p>A vertical complexity index, fixed normalization of entropy metric calculated above</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" data-line-number="1"><span class="co">#set zmax comofortably above maximum canopy height</span></a>
<a class="sourceLine" id="cb460-2" data-line-number="2"><span class="co">#by = 1 assesses the metric based on 1 m horizontal slices in </span></a>
<a class="sourceLine" id="cb460-3" data-line-number="3"><span class="co">#the canopy</span></a>
<a class="sourceLine" id="cb460-4" data-line-number="4">VCI.AOP &lt;-<span class="st"> </span><span class="kw">VCI</span>(Zs, <span class="dt">by =</span> <span class="dv">1</span>, <span class="dt">zmax=</span><span class="dv">100</span>) </a></code></pre></div>
<p>We now have 13 different structural diversity metrics. Let’s organize them into a new dataframe:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" data-line-number="1"><span class="co">#OUTPUT CALCULATED METRICS INTO A TABLE</span></a>
<a class="sourceLine" id="cb461-2" data-line-number="2"><span class="co">#creates a dataframe row, out.plot, containing plot descriptors </span></a>
<a class="sourceLine" id="cb461-3" data-line-number="3"><span class="co">#and calculated metrics</span></a>
<a class="sourceLine" id="cb461-4" data-line-number="4">HARV_structural_diversity &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb461-5" data-line-number="5"><span class="st">   </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(x, y, mean.max.canopy.ht, max.canopy.ht, </a>
<a class="sourceLine" id="cb461-6" data-line-number="6">                       rumple, deepgaps,deepgap.fraction,</a>
<a class="sourceLine" id="cb461-7" data-line-number="7">                       cover.fraction,top.rugosity, vert.sd, </a>
<a class="sourceLine" id="cb461-8" data-line-number="8">                       sd.sd, entro,GFP.AOP, VAI.AOP, VCI.AOP),</a>
<a class="sourceLine" id="cb461-9" data-line-number="9">                     <span class="dt">ncol =</span> <span class="dv">15</span>)) </a>
<a class="sourceLine" id="cb461-10" data-line-number="10"></a>
<a class="sourceLine" id="cb461-11" data-line-number="11"><span class="co">#provide descriptive names for the calculated metrics</span></a>
<a class="sourceLine" id="cb461-12" data-line-number="12"><span class="kw">colnames</span>(HARV_structural_diversity) &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb461-13" data-line-number="13"><span class="st">   </span><span class="kw">c</span>(<span class="st">&quot;easting&quot;</span>, <span class="st">&quot;northing&quot;</span>, <span class="st">&quot;mean.max.canopy.ht.aop&quot;</span>,</a>
<a class="sourceLine" id="cb461-14" data-line-number="14">     <span class="st">&quot;max.canopy.ht.aop&quot;</span>, <span class="st">&quot;rumple.aop&quot;</span>, <span class="st">&quot;deepgaps.aop&quot;</span>,</a>
<a class="sourceLine" id="cb461-15" data-line-number="15">     <span class="st">&quot;deepgap.fraction.aop&quot;</span>,<span class="st">&quot;cover.fraction.aop&quot;</span>, </a>
<a class="sourceLine" id="cb461-16" data-line-number="16">     <span class="st">&quot;top.rugosity.aop&quot;</span>, <span class="st">&quot;vert.sd.aop&quot;</span>, <span class="st">&quot;sd.sd.aop&quot;</span>, </a>
<a class="sourceLine" id="cb461-17" data-line-number="17">     <span class="st">&quot;entropy.aop&quot;</span>, <span class="st">&quot;GFP.AOP.aop&quot;</span>, <span class="st">&quot;VAI.AOP.aop&quot;</span>, <span class="st">&quot;VCI.AOP.aop&quot;</span>) </a>
<a class="sourceLine" id="cb461-18" data-line-number="18"></a>
<a class="sourceLine" id="cb461-19" data-line-number="19"><span class="co">#View the results</span></a>
<a class="sourceLine" id="cb461-20" data-line-number="20">HARV_structural_diversity </a></code></pre></div>
</div>
</div>
<div id="combining-everything-into-one-function" class="section level2">
<h2><span class="header-section-number">6.7</span> Combining Everything Into One Function</h2>
<p>Now that we have run through how to measure each structural diversity metric, let’s create a
convenient function to run these a little faster on the TEAK site for a comparison of structural
diversity with HARV.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" data-line-number="1"><span class="co">#Let&#39;s correct for elevation and measure structural diversity for TEAK</span></a>
<a class="sourceLine" id="cb462-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="dv">316400</span> </a>
<a class="sourceLine" id="cb462-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="dv">4091700</span></a>
<a class="sourceLine" id="cb462-4" data-line-number="4"></a>
<a class="sourceLine" id="cb462-5" data-line-number="5">data<span class="fl">.200</span>m &lt;-<span class="st"> </span><span class="kw">lasclipRectangle</span>(TEAK, </a>
<a class="sourceLine" id="cb462-6" data-line-number="6">                              <span class="dt">xleft =</span> (x <span class="op">-</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ybottom =</span> (y <span class="op">-</span><span class="st"> </span><span class="dv">100</span>),</a>
<a class="sourceLine" id="cb462-7" data-line-number="7">                              <span class="dt">xright =</span> (x <span class="op">+</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">ytop =</span> (y <span class="op">+</span><span class="st"> </span><span class="dv">100</span>))</a>
<a class="sourceLine" id="cb462-8" data-line-number="8"></a>
<a class="sourceLine" id="cb462-9" data-line-number="9">dtm &lt;-<span class="st"> </span><span class="kw">grid_terrain</span>(data<span class="fl">.200</span>m, <span class="dv">1</span>, <span class="kw">kriging</span>(<span class="dt">k =</span> 10L))</a>
<a class="sourceLine" id="cb462-10" data-line-number="10">data<span class="fl">.200</span>m &lt;-<span class="st"> </span><span class="kw">lasnormalize</span>(data<span class="fl">.200</span>m, dtm)</a>
<a class="sourceLine" id="cb462-11" data-line-number="11"></a>
<a class="sourceLine" id="cb462-12" data-line-number="12">data<span class="fl">.40</span>m &lt;-<span class="st"> </span><span class="kw">lasclipRectangle</span>(data<span class="fl">.200</span>m, </a>
<a class="sourceLine" id="cb462-13" data-line-number="13">                             <span class="dt">xleft =</span> (x <span class="op">-</span><span class="st"> </span><span class="dv">20</span>), <span class="dt">ybottom =</span> (y <span class="op">-</span><span class="st"> </span><span class="dv">20</span>),</a>
<a class="sourceLine" id="cb462-14" data-line-number="14">                             <span class="dt">xright =</span> (x <span class="op">+</span><span class="st"> </span><span class="dv">20</span>), <span class="dt">ytop =</span> (y <span class="op">+</span><span class="st"> </span><span class="dv">20</span>))</a>
<a class="sourceLine" id="cb462-15" data-line-number="15">data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z[data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.5</span>] &lt;-<span class="st"> </span><span class="dv">0</span>  </a>
<a class="sourceLine" id="cb462-16" data-line-number="16"><span class="kw">plot</span>(data<span class="fl">.40</span>m)</a></code></pre></div>
<p><img src="https://raw.githubusercontent.com/NEONScience/NEON-Data-Skills/dev-aten/graphics/lidar-point-clouds/TEAK40mx40m.JPG" /></p>
<blockquote>
<p>40 meter by 40 meter point cloud from Lower Teakettle showing a cross-section of the forest structure with several tall, pointed conifers separated by deep gaps in the canopy.</p>
</blockquote>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" data-line-number="1"><span class="co">#Zip up all the code we previously used and write function to </span></a>
<a class="sourceLine" id="cb463-2" data-line-number="2"><span class="co">#run all 13 metrics in a single function. </span></a>
<a class="sourceLine" id="cb463-3" data-line-number="3">structural_diversity_metrics &lt;-<span class="st"> </span><span class="cf">function</span>(data<span class="fl">.40</span>m) {</a>
<a class="sourceLine" id="cb463-4" data-line-number="4">   chm &lt;-<span class="st"> </span><span class="kw">grid_canopy</span>(data<span class="fl">.40</span>m, <span class="dt">res =</span> <span class="dv">1</span>, <span class="kw">dsmtin</span>()) </a>
<a class="sourceLine" id="cb463-5" data-line-number="5">   mean.max.canopy.ht &lt;-<span class="st"> </span><span class="kw">mean</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb463-6" data-line-number="6">   max.canopy.ht &lt;-<span class="st"> </span><span class="kw">max</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb463-7" data-line-number="7">   rumple &lt;-<span class="st"> </span><span class="kw">rumple_index</span>(chm) </a>
<a class="sourceLine" id="cb463-8" data-line-number="8">   top.rugosity &lt;-<span class="st"> </span><span class="kw">sd</span>(chm<span class="op">@</span>data<span class="op">@</span>values, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb463-9" data-line-number="9">   cells &lt;-<span class="st"> </span><span class="kw">length</span>(chm<span class="op">@</span>data<span class="op">@</span>values) </a>
<a class="sourceLine" id="cb463-10" data-line-number="10">   chm<span class="fl">.0</span> &lt;-<span class="st"> </span>chm</a>
<a class="sourceLine" id="cb463-11" data-line-number="11">   chm<span class="fl">.0</span>[<span class="kw">is.na</span>(chm<span class="fl">.0</span>)] &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb463-12" data-line-number="12">   zeros &lt;-<span class="st"> </span><span class="kw">which</span>(chm<span class="fl">.0</span><span class="op">@</span>data<span class="op">@</span>values <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb463-13" data-line-number="13">   deepgaps &lt;-<span class="st"> </span><span class="kw">length</span>(zeros) </a>
<a class="sourceLine" id="cb463-14" data-line-number="14">   deepgap.fraction &lt;-<span class="st"> </span>deepgaps<span class="op">/</span>cells </a>
<a class="sourceLine" id="cb463-15" data-line-number="15">   cover.fraction &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>deepgap.fraction </a>
<a class="sourceLine" id="cb463-16" data-line-number="16">   vert.sd &lt;-<span class="st"> </span><span class="kw">cloud_metrics</span>(data<span class="fl">.40</span>m, <span class="kw">sd</span>(Z, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) </a>
<a class="sourceLine" id="cb463-17" data-line-number="17">   sd<span class="fl">.1</span>m2 &lt;-<span class="st"> </span><span class="kw">grid_metrics</span>(data<span class="fl">.40</span>m, <span class="kw">sd</span>(Z), <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb463-18" data-line-number="18">   sd.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(sd<span class="fl">.1</span>m2[,<span class="dv">3</span>], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb463-19" data-line-number="19">   Zs &lt;-<span class="st"> </span>data<span class="fl">.40</span>m<span class="op">@</span>data<span class="op">$</span>Z</a>
<a class="sourceLine" id="cb463-20" data-line-number="20">   Zs &lt;-<span class="st"> </span>Zs[<span class="op">!</span><span class="kw">is.na</span>(Zs)]</a>
<a class="sourceLine" id="cb463-21" data-line-number="21">   entro &lt;-<span class="st"> </span><span class="kw">entropy</span>(Zs, <span class="dt">by =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb463-22" data-line-number="22">   gap_frac &lt;-<span class="st"> </span><span class="kw">gap_fraction_profile</span>(Zs, <span class="dt">dz =</span> <span class="dv">1</span>, <span class="dt">z0=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb463-23" data-line-number="23">   GFP.AOP &lt;-<span class="st"> </span><span class="kw">mean</span>(gap_frac<span class="op">$</span>gf) </a>
<a class="sourceLine" id="cb463-24" data-line-number="24">   LADen&lt;-<span class="kw">LAD</span>(Zs, <span class="dt">dz =</span> <span class="dv">1</span>, <span class="dt">k=</span><span class="fl">0.5</span>, <span class="dt">z0=</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb463-25" data-line-number="25">   VAI.AOP &lt;-<span class="st"> </span><span class="kw">sum</span>(LADen<span class="op">$</span>lad, <span class="dt">na.rm=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb463-26" data-line-number="26">   VCI.AOP &lt;-<span class="st"> </span><span class="kw">VCI</span>(Zs, <span class="dt">by =</span> <span class="dv">1</span>, <span class="dt">zmax=</span><span class="dv">100</span>) </a>
<a class="sourceLine" id="cb463-27" data-line-number="27">   out.plot &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb463-28" data-line-number="28">      <span class="kw">matrix</span>(<span class="kw">c</span>(x, y, mean.max.canopy.ht,max.canopy.ht, </a>
<a class="sourceLine" id="cb463-29" data-line-number="29">               rumple,deepgaps, deepgap.fraction, </a>
<a class="sourceLine" id="cb463-30" data-line-number="30">               cover.fraction, top.rugosity, vert.sd, </a>
<a class="sourceLine" id="cb463-31" data-line-number="31">               sd.sd, entro, GFP.AOP, VAI.AOP,VCI.AOP),</a>
<a class="sourceLine" id="cb463-32" data-line-number="32">             <span class="dt">ncol =</span> <span class="dv">15</span>)) </a>
<a class="sourceLine" id="cb463-33" data-line-number="33">   <span class="kw">colnames</span>(out.plot) &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb463-34" data-line-number="34"><span class="st">      </span><span class="kw">c</span>(<span class="st">&quot;easting&quot;</span>, <span class="st">&quot;northing&quot;</span>, <span class="st">&quot;mean.max.canopy.ht.aop&quot;</span>,</a>
<a class="sourceLine" id="cb463-35" data-line-number="35">        <span class="st">&quot;max.canopy.ht.aop&quot;</span>, <span class="st">&quot;rumple.aop&quot;</span>, <span class="st">&quot;deepgaps.aop&quot;</span>,</a>
<a class="sourceLine" id="cb463-36" data-line-number="36">        <span class="st">&quot;deepgap.fraction.aop&quot;</span>, <span class="st">&quot;cover.fraction.aop&quot;</span>,</a>
<a class="sourceLine" id="cb463-37" data-line-number="37">        <span class="st">&quot;top.rugosity.aop&quot;</span>,<span class="st">&quot;vert.sd.aop&quot;</span>,<span class="st">&quot;sd.sd.aop&quot;</span>, </a>
<a class="sourceLine" id="cb463-38" data-line-number="38">        <span class="st">&quot;entropy.aop&quot;</span>, <span class="st">&quot;GFP.AOP.aop&quot;</span>,</a>
<a class="sourceLine" id="cb463-39" data-line-number="39">        <span class="st">&quot;VAI.AOP.aop&quot;</span>, <span class="st">&quot;VCI.AOP.aop&quot;</span>) </a>
<a class="sourceLine" id="cb463-40" data-line-number="40">   <span class="kw">print</span>(out.plot)</a>
<a class="sourceLine" id="cb463-41" data-line-number="41">}</a>
<a class="sourceLine" id="cb463-42" data-line-number="42"></a>
<a class="sourceLine" id="cb463-43" data-line-number="43">TEAK_structural_diversity &lt;-<span class="st"> </span><span class="kw">structural_diversity_metrics</span>(data<span class="fl">.40</span>m)</a></code></pre></div>
</div>
<div id="comparing-metrics-between-forests" class="section level2">
<h2><span class="header-section-number">6.8</span> Comparing Metrics Between Forests</h2>
<p>How does the structural diversity of the evergreen TEAK forest compare to the mixed deciduous/evergreen forest from HARV? Let’s combine the result data.frames for a direct comparison:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" data-line-number="1">combined_results=<span class="kw">rbind</span>(HARV_structural_diversity, </a>
<a class="sourceLine" id="cb464-2" data-line-number="2">                       TEAK_structural_diversity)</a>
<a class="sourceLine" id="cb464-3" data-line-number="3"></a>
<a class="sourceLine" id="cb464-4" data-line-number="4"><span class="co"># Add row names for clarity</span></a>
<a class="sourceLine" id="cb464-5" data-line-number="5"><span class="kw">row.names</span>(combined_results)=<span class="kw">c</span>(<span class="st">&quot;HARV&quot;</span>,<span class="st">&quot;TEAK&quot;</span>)</a>
<a class="sourceLine" id="cb464-6" data-line-number="6"></a>
<a class="sourceLine" id="cb464-7" data-line-number="7"><span class="co"># Take a look to compare</span></a>
<a class="sourceLine" id="cb464-8" data-line-number="8">combined_results</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="flux-measurements-inter-operability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frequently-asked-questions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/katharynduffy/katharynduffy.github.io/edit/master/07-NEON_AOP.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Environmental Informatics Using Research Infrastructures and their Data.pdf", "Environmental Informatics Using Research Infrastructures and their Data.epub"],
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

</body>

</html>
